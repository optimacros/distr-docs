---
title: Обновление установленной версии дистрибутива Воркспейса
description: 
published: true
date: 2022-11-28T08:36:48.248Z
tags: workspace, update
editor: markdown
dateCreated: 2022-11-28T08:36:48.248Z
---

Как правило, почти у всех клиентов в целях безопасности, нет прямого доступа к серверу и установка новой версии дистрибутива начинается в подключения к сети VPN. В этом отношении у разных клиентов могут быть разные клиенты для 
предоставления VPN доступов FortiClient VPN, Open VPN, Cisco и т.д.

Попав в сеть VPN, мы получаем доступ к серверу на котором установлена старая версия дистрибутива. Далее нам нужно [залить новую версию дистрибутива](/ru/workspace/maintenance/upload) на машину, которая находится в VPN сети. 

Выполняем подключение к удаленному серверу по протоколу ssh и переходим в режим супер пользователя с помощью команды 
```bash 
sudo su
``` 
Переходим в директорию ```/om/``` в которой мы увидим директорию установленного Логин Центра ```login-center``` (если он установлен на однм сервер с воркспейсом), директорию установленного воркспейса ```workspace1``` и директорию с дистрибутивами ```workspace-installer```, внутри которой есть две директории ```prev``` и ```current```.
![sshputty1.jpg](/maintenance/sshputty1.jpg)


В директории ```prev``` мы можем увидеть файлы предыдущей версии дистрибутива установленной на этом сервере, а в папке ```current``` будет находиться та версия которая установлена на данный момент.

Далее мы должны будем удалить директорию ```prev``` с помощью команды 
```bash 
rm -rf prev/
```
, а содержимое ```current``` поместить во вновь созданную директорию ```prev``` с помощью команды 
```bash
mv current prev
```
После этого у нас останется только директория ```prev``` содержащая файлы текущего установленного дистрибутива. Теперь создаём новую директорию ```current``` командой 
```bash
mkdir current
```
затем мы должны распаковать tar архив в созданную директорию ```current```. Это мы делаем с помощью команды:

```bash
tar -xf /home/user/installer-132.tar -C current
```
![sshputty2.jpg](/maintenance/sshputty2.jpg)

Теперь у нас есть новая директория ```current``` в которой находится содержимое архива новой актуальной версии дистрибутива Optimacros. Из неё мы и будем производить установку, но для начала нам нужно остановить работу воркспейса, создав бекапы моделей. Это делается с помощью команды:
 
``` bash
current/install workspace --path /om/workspace1/manifest.json shutdown
```
![sshputty3.jpg](/maintenance/sshputty3.jpg)


Если после ввода команды мы увидели в командной строке зелёную строку текста: 

```Load manifest '/om/workspace1/manifest.json'```
![sshputty4.jpg](/maintenance/sshputty4.jpg)

Значит мы ввели команду правильно и находимся на верном пути, далее нам нужно ожидать пока создадутся бекапы моделей и остановится воркспейс.

![sshputty5.jpg](/maintenance/sshputty5.jpg)

По завершению всех операций, вывод консоли будет выглядеть вот так:

![sshputty6.jpg](/maintenance/sshputty6.jpg)
> Если вы обновляете воркспейс с версии < 2.3.2 следует внести правки в `manifest.json` [по инструкции](/ru/workspace/maintenance/update2.3.2)
{.is-warning}

> Перед запуском новой версии дистрибутива требуется сделать резервную копию каталога с установленным воркспейсом. 
{.is-warning}


Далее на нужно запустить команду, которая восстановит все клиентские модели из бекапов и запустит воркспейс:

```bash
current/install workspace --path /om/workspace1/manifest.json up
```

![sshputty7.jpg](/maintenance/sshputty7.jpg)

Время ожидания будет напрямую зависеть от размера и количества моделей у клиентов. В случае успеха, мы сможем увидеть 
вот такой вывод терминала:

![sshputty8.jpg](/maintenance/sshputty8.jpg)


После чего следует удостовериться, что вокрспейс поднялся успешно и убедиться в работоспособности Optimacros'а. Открываем клиентскую логин панель и авторизуемся под любым пользователем.
![logincenter.jpg](/maintenance/logincenter.jpg)
![controlcheck.jpg](/maintenance/controlcheck.jpg)

Если после авторизации становится доступным воркспейс и открывается без ошибок, значит установка новой версии дистрибутива подошла к концу. После этого желательно удалить на сервере архив с дистрибутивом, который мы загружали с помощью WinSCP, в целях экономии места.