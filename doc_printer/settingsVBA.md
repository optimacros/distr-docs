---
title: РАЗВЁРТЫВАНИЕ VBA AGENT 1.3.1
description: РАЗВЁРТЫВАНИЕ VBA AGENT 1.3.1
published: true
date: 2023-02-20T18:06:18.799Z
tags: 
editor: markdown
dateCreated: 2023-02-20T18:06:18.799Z
---

# РАЗВЁРТЫВАНИЕ VBA AGENT 1.3.1:

Скачиваем дистрибутив https://nextcloud.optimacros.com/s/DTEM4WjGjrzeBNa

Внутри находятся 2 компонента: VBA AGENT и nginx для reverse proxy.
VBA AGENT в настройке не нуждается, по сути требуется настройка только nginx и windows

Для автоматизации настройки запускаем deploy.ps1 (через контекстное меню).

 После чего нам будут задаваться вопросы по пунктам:

А. Под повышенными привилегиями (будет запрос на ввод пароля) открывает 3001 порт (обычно на него принимаем запросы от воркспейсов)

Б. Если версия Windows не русская, то нужно установить корректные локали, на что направлено следующее подтверждение: скрипт ставит в качестве раскладок английскую и русскую и ставит в параметрах региона Россию (для корректного открытия .csv), под повышенными привилегиями ставит русский в качестве языка non-Unicode (нужно для корректного открытия .csv)
>:warning:`Без перезагрузки русская кодировка не поставится`

В. Ввод имени сервера (я ставлю конкретный ip, можно и _ поставить), чтобы прописать в настройках nginx

Г. Нужна ли настройка базовой аутентификации, и если нужна, попросит ввести пару login:apache-md5 hash (если ставим в закрытый контур или не собираемся ставить брокер, то аутентификация излишня, да и воркспейс не умеет с ней работать)

Д. Далее будет вопрос, создавать ли ярлыки в папке автозапуска, чтобы после перезагрузки всё само работало (рекомендуется создавать)

Далее рекомендуется перезагрузить ОС WIndows, чтобы убедиться что всё хорошо. Но также можно просто запустить nginx и сам VBA AGENT через бат файлы, лежащие рядом в корневой директории VBA AGENT.

Корректный запуск агента выглядит так:

![vbaagentrun.jpg](/doc_printer/vbaagentrun.jpg)

Существует возможность проверки результата работы VBA AGENT в браузере. Для этого введите в адресной строке браузера: `http://ip_adress_or_domain:3001/status`. Корректный ответ выглядит так:

```
{"XLqueueLength":0,"WDqueueLength":0,"PPqueueLength":0,"foldersOnDisk":0,"XLprocesses":0,"WDprocesses":0,"PPprocesses":0}
```

Для уменьшения числа странностей отключаем в Excel, Word и PowerPoint автосохранение (оно везде в одном месте)

![wordsettings.jpg](/doc_printer/wordsettings.jpg)

После этого можно проводить тестирование работы VBA AGENT на воркспейсе Optimacros/

[Вернуться к содержанию <](/doc_printer/home)

[Вернуться к оглавлению <<](/home)